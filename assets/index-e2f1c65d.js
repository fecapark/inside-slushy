(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function i(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(s){if(s.ep)return;s.ep=!0;const a=i(s);fetch(s.href,a)}})();class o{constructor(t,i){this.x=t,this.y=i}copy(){return new o(this.x,this.y)}add(t){return new o(this.x+t.x,this.y+t.y)}sub(t){return new o(this.x-t.x,this.y-t.y)}mul(t){return new o(this.x*t,this.y*t)}div(t){return t===0?new o(0,0):new o(this.x/t,this.y/t)}dist(t){return this.sub(t).norm()}norm(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}normalize(){return this.div(this.norm())}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}}class M{constructor(t,i){this.ctx=t,this.app=i,this.maxWidth=0,this.width=0,this.height=0,this.heightRatio=.08,this.interactionAreaRadius=0,this.pos=new o(0,0),this.topLeft=new o(0,0),this.rotate=0,this.rspeed=-.08,this.maxRspeed=.012,this.sizeSpeed=0,this.shadowOpacity=.4,this.pauseSpining=!1,this.appears=!1,this.rotateClockWise=!0}update(){this.spin(),this.appears||(this.rePosition(this.app.stageWidth,this.app.stageHeight),this.appearAnimation())}draw(){this.ctx.save(),this.setRotated(),this.drawShadow(),this.drawSpinner(),this.drawScrew(),this.ctx.restore()}spin(){const t=this.app.getModules().pointerManager,i=.001;!this.appears||this.pauseSpining||(t.isSpinnerDown||(this.rspeed+=i,this.rspeed=Math.min(this.rspeed,this.maxRspeed),this.rotate+=this.rspeed*(this.rotateClockWise?1:-1)),this.rotate%=2*Math.PI)}setRotated(){this.ctx.translate(this.pos.x,this.pos.y),this.ctx.rotate(this.rotate),this.ctx.translate(-this.pos.x,-this.pos.y)}drawShadow(){this.appears&&(this.shadowOpacity-=.06,this.shadowOpacity=Math.max(this.shadowOpacity,0)),this.ctx.shadowColor=`rgba(0, 0, 0, ${this.shadowOpacity})`,this.ctx.shadowBlur=5,this.app.getModules().pointerManager.isSpinnerDown?(this.shadowOpacity=.4,this.ctx.shadowOffsetX=7,this.ctx.shadowOffsetY=7):(this.ctx.shadowOffsetX=4,this.ctx.shadowOffsetY=4)}drawSpinner(){this.ctx.fillStyle="white",this.ctx.fillRect(this.topLeft.x,this.topLeft.y,this.width,this.height)}drawScrew(){const t=this.height/6;this.ctx.beginPath(),this.ctx.shadowBlur=0,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0,this.ctx.fillStyle="#c3c3c3",this.ctx.arc(this.pos.x,this.pos.y,t,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.strokeStyle="#858585",this.ctx.lineWidth=2,this.ctx.moveTo(this.pos.x-t*.6,this.pos.y),this.ctx.lineTo(this.pos.x+t*.6,this.pos.y),this.ctx.moveTo(this.pos.x,this.pos.y-t*.6),this.ctx.lineTo(this.pos.x,this.pos.y+t*.6),this.ctx.stroke()}appearAnimation(){const i=(this.maxWidth-this.width)/6;this.sizeSpeed+=i,this.sizeSpeed*=.8,this.width+=this.sizeSpeed,this.height=this.width*this.heightRatio,Math.abs(this.maxWidth-this.width)<.01&&(this.appears=!0,this.app.getModules().guideManager.guidingSpinner=!0,this.app.getModules().guideManager.startFadeIn=!0)}resize(t,i){this.maxWidth>0?(this.maxWidth=Math.min(t,i)*.9,this.width=this.maxWidth,this.height=this.width*this.heightRatio):this.maxWidth=Math.min(t,i)*.9,this.balanceInteractionAreaSize(),this.rePosition(t,i)}rePosition(t,i){this.pos.x=t/2,this.pos.y=i/2,this.topLeft.x=this.pos.x-this.width/2,this.topLeft.y=this.pos.y-this.height/2}balanceInteractionAreaSize(){this.interactionAreaRadius=Math.sqrt(Math.pow(this.maxWidth/2,2)+Math.pow(this.maxWidth*this.heightRatio/2,2))}}function x(p,t,i,e){function s(a){a=Math.max(0,Math.min(1,a));const h=1-a,l=new o(0,0),r=new o(p,t),n=new o(i,e),d=new o(1,1),u=l.mul(h).add(r.mul(a)),c=r.mul(h).add(n.mul(a)),g=n.mul(h).add(d.mul(a)),f=u.mul(h).add(c.mul(a)),y=c.mul(h).add(g.mul(a));return f.mul(h).add(y.mul(a)).y}return s}class S{constructor(t,i,e,s,a,h,l){this.ctx=t,this.app=i,this.stageWidth=e,this.stageHeight=s,this.radius=0,this.maxRadius=l,this.pos=new o(a,h),this.dir=this.getInitedDir(),this.rotatedBallPos=new o(0,0),this.radiusSpeed=0,this.frictionValue=.985,this.maxSpeed=24,this.minSpeed=7,this.speed=this.maxSpeed,this.opacity=0,this.shadowOpacity=.4,this.appears=!1,this.isAcceling=!0,this.promiseDead=!1,this.isDead=!0,this.growthAnimator=null,this.shrinkAnimator=null}resize(t,i,e,s){this.stageWidth=t,this.stageHeight=i,this.pos.x*=t/e,this.pos.y*=i/s}update(t){if(this.promiseDead){this.animateShrink();return}if(!this.appears){this.animateGrowth(),this.preventGettingOut();return}t||(this.bounceOnSpinner(),this.bounceOnFrame(),this.friction(),this.pos=this.pos.add(this.dir.mul(this.speed)))}draw(){this.ctx.beginPath(),this.drawShadow(),this.ctx.fillStyle=`rgba(250, 185, 63, ${this.opacity})`,this.ctx.arc(this.pos.x,this.pos.y,this.radius,0,Math.PI*2),this.ctx.fill()}drawShadow(){this.appears&&(this.shadowOpacity-=.025,this.shadowOpacity=Math.max(this.shadowOpacity,0)),this.ctx.shadowColor=`rgba(0, 0, 0, ${this.shadowOpacity})`,this.ctx.shadowBlur=5,this.ctx.shadowOffsetX=4,this.ctx.shadowOffsetY=4}fenceValueAsPosition(t,i){return Math.min(Math.max(t,this.maxRadius+1),i-this.maxRadius-1)}preventGettingOut(){this.stageWidth>this.stageHeight?this.pos.x=Math.min(Math.max(this.pos.x,this.radius+1),this.stageWidth-this.radius-1):this.pos.y=Math.min(Math.max(this.pos.y,this.radius+1),this.stageHeight-this.radius-1)}animateGrowth(){this.growthAnimator||(this.growthAnimator=this.getRadiusAnimator(this.radius,this.opacity,.5)),this.growthAnimator()&&(this.appears=!0,this.growthAnimator=null)}animateShrink(){this.shrinkAnimator||(this.shrinkAnimator=this.getRadiusAnimator(this.radius,this.opacity,.3,!0)),this.shrinkAnimator()&&(this.shrinkAnimator=null,this.isDead=!0)}getRadiusAnimator(t,i,e,s=!1){const a={growth:[.3,2,.65,1],shrink:[.6,-.28,.73,.05]};let h=null;const l=x(...s?a.shrink:a.growth);return()=>{h||(h=new Date);const n=(new Date-h)/1e3,d=Math.min(n/e,1),u=l(d);return s?(this.radius=t*(1-u),this.opacity=i*(1-u)):(this.radius=(this.maxRadius-t)*u+t,this.opacity=(1-i)*u+i),u===1}}getInitedDir(){const t=[[1,1],[-1,1],[1,-1],[-1,-1]],i=Math.floor(Math.random()*4);return new o(t[i][0],t[i][1])}friction(){this.speed*=this.frictionValue,this.speed=Math.min(Math.max(this.speed,this.minSpeed),this.maxSpeed)}bounceOnFrame(){this.stageWidth>this.stageHeight?((this.pos.x<=this.radius||this.pos.x>=this.app.stageWidth-this.radius)&&(this.dir.x*=-1,this.pos.x+=this.dir.x*this.speed),this.dir.y<0&&this.pos.y<-this.radius*1.1&&(this.pos.y=this.stageHeight+this.radius*1.1,this.speed=this.maxSpeed),this.dir.y>0&&this.pos.y>this.stageHeight+this.radius*1.1&&(this.pos.y=-this.radius*1.1,this.speed=this.maxSpeed)):this.pos.y<=this.radius||this.pos.y>=this.app.stageHeight-this.radius?(this.dir.y*=-1,this.pos.y+=this.dir.y*this.speed):this.dir.x<0&&this.pos.x<-this.radius*1.1?(this.pos.x=this.stageWidth+this.radius*1.1,this.speed=this.maxSpeed):this.dir.x>0&&this.pos.x>this.stageWidth+this.radius*1.1&&(this.pos.x=-this.radius*1.1,this.speed=this.maxSpeed)}bounceOnSpinner(){const t=(r,n,d)=>{const u=Math.cos(-d)*(r.x-n.x)-Math.sin(-d)*(r.y-n.y)+n.x,c=Math.sin(-d)*(r.x-n.x)+Math.cos(-d)*(r.y-n.y)+n.y;return new o(u,c)},i=(r,n,d,u)=>{const c=new o(0,0);return r.x<=n.x?c.x=n.x:r.x>=n.x+d?c.x=n.x+d:c.x=r.x,r.y<=n.y?c.y=n.y:r.y>=n.y+u?c.y=n.y+u:c.y=r.y,c},e=(r,n,d)=>d.dist(n)<=r,s=(r,n,d)=>{const u=this.app.getModules().spinner,c=t(n,u.pos,-d),g=r.sub(c).normalize();return this.dir.add(g).normalize()},a=this.app.getModules().spinner,h=t(this.pos,a.pos,a.rotate);this.rotatedBallPos=h;const l=i(h,a.topLeft,a.width,a.height);e(this.radius,h,l)&&(this.isAcceling=!0,this.dir=s(this.pos,l,a.rotate),this.pos.x+=this.dir.x*this.speed*2,this.pos.y+=this.dir.y*this.speed*2)}}class b{constructor(t,i){this.ctx=t,this.app=i,this.balls=[],this.willDeadBalls=[],this.firstBallInfos=null,this.stopBallMovements=!1,this.createdWhenStart=!1,this.maxBallNum=20,this.initBallNum=2}getFirstBallInfos(t,i){const e=n=>Math.floor(Math.random()*2)===0?[n[0],n[3]]:[n[1],n[2]],s=n=>{const d=h*.5,u=n*i;return Math.max(u,d+t.width/2)},a=(n,d)=>{const u=s(d),c=d*i,g=n.x+Math.random()*(this.stageWidth/2-2*u)+u,f=n.y+Math.random()*(this.stageHeight/2-2*(c+h))+c;return new o(g,f)};if(this.firstBallInfos)return this.firstBallInfos;const h=14,l=[new o(0,0),new o(this.stageWidth/2,0),new o(0,this.stageHeight/2),new o(this.stageWidth/2,this.stageHeight/2)],r=e(l);this.firstBallInfos=[];for(let n=0;n<this.initBallNum;n++)this.firstBallInfos.push({pos:null,maxRadius:this.getNewBallMaxRadius()});for(let n=0;n<this.firstBallInfos.length;n++){const d=this.firstBallInfos[n];d.pos=a(r[n],d.maxRadius)}return this.firstBallInfos}draw(){for(const t of[...this.balls,...this.willDeadBalls])t.draw()}update(){this.bounceOnBalls();for(const t of[...this.balls,...this.willDeadBalls])t.update(this.stopBallMovements)}resize(t,i,e,s){this.stageWidth=t,this.stageHeight=i;for(const a of[...this.balls,...this.willDeadBalls])a.resize(t,i,e,s);if(this.firstBallInfos)for(const a of this.firstBallInfos)a.pos.x*=t/e,a.pos.y*=i/s}getNewBallMaxRadius(){const{scaleRatio:t,stageWidth:i,stageHeight:e}=this.app;if(t<1)return Math.random()*40+40;const s=Math.max(i,e),h=Math.max(s/2400,1);return(Math.random()*60+60)*h}createBallsOnStart(){if(!this.createdWhenStart){this.createdWhenStart=!0;for(let t=0;t<this.initBallNum;t++)this.createNewBall(this.firstBallInfos[t].pos.x,this.firstBallInfos[t].pos.y,this.firstBallInfos[t].maxRadius)}}createNewBall(t,i,e){const s=()=>{for(let h=this.balls.length-this.maxBallNum-1;h>=0;h--){const l=this.balls[h];l.promiseDead||(l.promiseDead=!0,this.balls.splice(h,1),this.willDeadBalls.push(l))}},a=new S(this.ctx,this.app,this.stageWidth,this.stageHeight,t,i,e||this.getNewBallMaxRadius());this.balls.push(a),s()}checkDeadBalls(){for(let t=this.willDeadBalls.length-1;t>=0;t--)this.willDeadBalls[t].isDead&&this.willDeadBalls[t].splice(t,1)}fenceValueAsPosition(t,i,e){return Math.min(Math.max(t,e+1),i-e-1)}bounceOnBalls(){const t=(e,s)=>{const a=e.pos.dist(s.pos),h=e.radius+s.radius-a,l=e.pos.sub(s.pos).normalize().mul(h/2),r=e.pos.sub(s.pos).normalize().mul(-h/2);e.pos=e.pos.add(l),s.pos=s.pos.add(r)},i=(e,s)=>{const a=s.pos.sub(e.pos).div(s.pos.dist(e.pos)),h=2*(e.dir.dot(a)-s.dir.dot(a))/(e.radius+s.radius);e.dir=e.dir.sub(a.mul(e.radius).mul(h)).normalize(),s.dir=s.dir.add(a.mul(s.radius).mul(h)).normalize()};for(let e=0;e<this.balls.length-1;e++)for(let s=e+1;s<this.balls.length;s++){const a=this.balls[e],h=this.balls[s];a.pos.dist(h.pos)<=a.radius+h.radius&&(t(a,h),i(a,h))}}}class v{constructor(t,i){this.ctx=t,this.app=i,this.offsetPos=new o(0,0),this.preventEvent=!1,this.isSpinnerDown=!1,this.isBackgroundDown=!1,document.addEventListener("pointerdown",this.onPointerDown.bind(this)),document.addEventListener("pointermove",this.onPointerMove.bind(this)),document.addEventListener("pointerup",this.onPointerUp.bind(this)),document.querySelector(".about").addEventListener("pointerdown",()=>{this.preventEvent=!0})}isDowninSpinnerArea(t,i){const e=this.app.getModules().spinner;return e.pos.dist(new o(t,i))<=e.interactionAreaRadius}onPointerDown(t){if(this.time=new Date,this.preventEvent||!this.app.startInteraction)return;const i=new o(t.clientX,t.clientY),e=i.div(this.app.scaleRatio);this.isDowninSpinnerArea(e.x,e.y)?(this.isSpinnerDown=!0,this.offsetPos=i):this.isBackgroundDown=!0}onPointerMove(t){const i=(new Date-this.time)/1e3;this.time=new Date;const e=s=>{const a=this.app.scaleRatio,h=new o(t.clientX,t.clientY).div(a).sub(s),l=h.cross(this.offsetPos.div(a).sub(s));return Math.asin(l/(h.norm()*this.offsetPos.div(a).norm()))<0};if(this.isSpinnerDown){const a=this.app.getModules().spinner,h=new o(t.clientX,t.clientY).sub(this.offsetPos);console.log(h.norm());const l=Math.min(h.norm()*.01,a.maxRspeed*2);e(a.pos)?(a.rotate+=l*i*60,a.rotateClockWise=!0):(a.rotate-=l*i*60,a.rotateClockWise=!1),this.offsetPos=new o(t.clientX,t.clientY)}}onPointerUp(t){const i=()=>{const s=this.app.getModules().guideManager.getCurrentGuide();s&&s.isFadeIned&&s.triggerExitGuide()};if(this.preventEvent){this.preventEvent=!1;return}if(i(),!!this.app.startInteraction){if(this.isBackgroundDown){const e=new o(t.clientX,t.clientY).div(this.app.scaleRatio);this.app.getModules().ballManager.createNewBall(e.x,e.y)}this.isSpinnerDown=!1,this.isBackgroundDown=!1}}}class m{constructor(t,i,e,s){this.text=t,this.pos=new o(i,e),this.radius=s}}class w{constructor(t,i,e){this.$canvas=t,this.app=e,this.ctx=i,this.guideInfos=[],this.pixelRatio=this.app.pixelRatio,this.fontSize=0,this.opacity=0,this.fadeDuration=.3,this.isRunning=!1,this.isFadeIned=!1,this.isFadeOuted=!1,this.onExitState=!1,this.fadeInAnimator=null,this.fadeOutAnimator=null,this.guideDurationTimeout=null}draw(){const t=()=>{this.ctx.beginPath(),this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(0,0,this.app.stageWidth,this.app.stageHeight)},i=s=>{this.ctx.beginPath(),this.ctx.globalCompositeOperation="destination-out",this.ctx.fillStyle="rgba(255, 255, 255, 1)",this.ctx.arc(s.pos.x,s.pos.y,s.radius,0,Math.PI*2),this.ctx.fill()},e=s=>{this.ctx.beginPath(),this.ctx.globalCompositeOperation="source-over",this.ctx.font=`bold ${this.fontSize}px Roboto`,this.ctx.fillStyle="white",this.ctx.textAlign="center",this.ctx.fillText(s.text,s.pos.x,s.pos.y+s.radius+this.fontSize*1.5)};this.ctx.clearRect(0,0,this.app.stageWidth,this.app.stageHeight),t();for(const s of this.guideInfos)i(s),e(s);this.$canvas.style.opacity=this.opacity}update(){}setGuideInfos(t){this.guideInfos=t}clearGuideDurationTimeout(){clearTimeout(this.guideDurationTimeout),this.guideDurationTimeout=null}getMetrices(t){return this.ctx.beginPath(),this.ctx.font=`bold ${this.fontSize}px Roboto`,this.ctx.measureText(t)}resize(t,i){const{scaleRatio:e}=this.app;this.stageWidth=t,this.stageHeight=i,e<1?this.fontSize=14*(.9/e):this.fontSize=14}resizeFont(){}fadeInGuide(t=null){if(!this.isFadeIned)if(!this.fadeInAnimator)this.isRunning=!0,this.fadeInAnimator=this.getFadeAnimator(this.opacity,this.fadeDuration,!0);else{const[i,e]=this.fadeInAnimator();this.opacity=i,e&&(this.isFadeIned=!0,this.fadeInAnimator=null,t&&t())}}fadeOutGuide(t=null){if(!this.isFadeOuted)if(!this.fadeOutAnimator)this.fadeOutAnimator=this.getFadeAnimator(this.opacity,this.fadeDuration);else{const[i,e]=this.fadeOutAnimator();this.opacity=i,e&&(this.isRunning=!1,this.isFadeOuted=!0,this.fadeOutAnimator=null,t&&t())}}getFadeAnimator(t,i,e=!1){let s=null;const a=x(0,0,1,1);return()=>{s||(s=new Date);const l=(new Date-s)/1e3,r=Math.min(l/i,1),n=a(r);return[e?(1-t)*n+t:t*(1-n),n===1]}}triggerExitGuide(){this.onExitState||(this.onExitState=!0)}}class B extends w{constructor(t,i,e){super(t,i,e),this.spinnerGuide=new m("Hold & Spin",0,0,0),this.guideDuration=2.5,super.setGuideInfos([this.spinnerGuide])}update(){const t=this.app.getModules().guideManager;this.onExitState?this.onExitState&&this.fadeOutGuide(()=>{this.clearGuideDurationTimeout(),setTimeout(()=>{t.startNextGuide()},t.guideInterval*1e3)}):this.fadeInGuide(()=>{this.guideDurationTimeout=setTimeout(()=>{this.onExitState=!0},this.guideDuration*1e3)}),this.manageSpinnerSpin()}resize(t,i,e){super.resize(t,i);const s=this.app.getModules().spinner,a=1/3,h=.9;this.spinnerGuide.pos.x=s.pos.x*a+s.topLeft.x*(1-a),this.spinnerGuide.pos.y=s.pos.y,this.spinnerGuide.radius=s.height*h}manageSpinnerSpin(){const t=this.app.getModules().spinner;this.isRunning?t.pauseSpining=!0:t.pauseSpining=!1}}class R extends w{constructor(t,i,e){super(t,i,e),this.text="Touch background",this.radiusScale=1.7,this.ballGuides=this.createBallGuides(),this.guideDuration=2.5,super.setGuideInfos(this.ballGuides)}update(){const t=this.app.getModules().guideManager,i=this.app.getModules().ballManager;this.onExitState?this.onExitState&&this.fadeOutGuide(()=>{this.clearGuideDurationTimeout(),i.stopBallMovements=!1,t.startNextGuide()}):this.fadeInGuide(()=>{this.guideDurationTimeout=setTimeout(()=>{this.onExitState=!0},this.guideDuration*1e3),i.stopBallMovements=!0,i.createBallsOnStart()})}resize(t,i,e){super.resize(t,i);for(const s of this.ballGuides)s.pos.x*=t/this.app.previousWidth,s.pos.y*=i/this.app.previousHeight}createBallGuides(){const t=[],e=this.app.getModules().ballManager.getFirstBallInfos(this.getMetrices(this.text),this.radiusScale);for(const s of e)t.push(new m(this.text,s.pos.x,s.pos.y,s.maxRadius*this.radiusScale));return t}}class G{constructor(t,i){this.app=t,this.$canvas=i,this.ctx=i.getContext("2d"),this.currentGuideIndex=-1,this.guides=[],this.guideInterval=1}setGuide(){this.currentGuideIndex=0,this.guides=[new B(this.$canvas,this.ctx,this.app),new R(this.$canvas,this.ctx,this.app)],this.resize(this.app.stageWidth,this.app.stageHeight,this.app.scaleRatio)}startNextGuide(t=1){this.currentGuideIndex+=t}getCurrentGuide(){return this.isGuideNotStart()||this.isAllGuideEnd()?null:this.guides[this.currentGuideIndex]}draw(){this.isGuideNotStart()||this.isAllGuideEnd()||this.getCurrentGuide().draw()}update(){this.isGuideNotStart()||this.isAllGuideEnd()||this.getCurrentGuide().update()}resize(t,i,e,s){if(this.$canvas.width=t,this.$canvas.height=i,this.ctx.scale(s,s),!this.isGuideNotStart())for(const a of this.guides)a.resize(t,i,e)}isGuideNotStart(){return this.currentGuideIndex<0}isAllGuideEnd(){return this.currentGuideIndex>=this.guides.length}}class D{constructor(t){this.$canvas=t,this.ctx=this.$canvas.getContext("2d"),this.prevFrameTime=performance.now(),this.startSpinner=!1,this.startInteraction=!1,this.stageWidth=0,this.stageHeight=0,this.previousWidth=document.body.clientWidth,this.previousHeight=document.body.clientHeight,this.spinner=new M(this.ctx,this),this.ballManager=new b(this.ctx,this),this.guideManager=new G(this,document.getElementById("guide-canvas")),window.addEventListener("resize",this.resize.bind(this)),this.resize(),this.animate(),this.initTransitions(),this.pointerManager=new v(this.ctx,this)}resize(){this.pixelRatio=window.devicePixelRatio>1?2:1,this.stageWidth=document.body.clientWidth,this.stageHeight=document.body.clientHeight,this.$canvas.width=this.stageWidth*this.pixelRatio,this.$canvas.height=this.stageHeight*this.pixelRatio,this.ctx.scale(this.pixelRatio,this.pixelRatio);const t=650,i=650,[e,s]=this.getScaleRatio(t,i);this.setStageSizeByScaledType(s,t,i),this.setResizedStageSize(e),this.spinner.resize(this.stageWidth,this.stageHeight),this.ballManager.resize(this.stageWidth,this.stageHeight,this.previousWidth,this.previousHeight),this.guideManager.resize(this.stageWidth,this.stageHeight,this.scaleRatio,this.pixelRatio),this.previousWidth=this.stageWidth,this.previousHeight=this.stageHeight}animate(){const t=()=>{this.ctx.beginPath(),this.ctx.fillStyle="#0ebbaa",this.ctx.fillRect(0,0,this.$canvas.width,this.$canvas.height)},i=()=>{this.startSpinner&&(s&&this.spinner.update(this.stageWidth),this.spinner.draw())},e=()=>{s&&this.ballManager.update(),this.ballManager.draw()};requestAnimationFrame(this.animate.bind(this));let s=!1;const a=1e3/65;performance.now()-this.prevFrameTime>a&&(s=!0,this.prevFrameTime=performance.now()),this.ctx.clearRect(0,0,this.$canvas.width,this.$canvas.height),t(),this.guideManager.isGuideNotStart()&&this.spinner.appears&&this.guideManager.setGuide(),this.guideManager.isAllGuideEnd()?(document.querySelector(".about").style.display="block",document.querySelector(".about").innerHTML=`Copyright &copy; ${new Date().getFullYear()} Sanghyeok Park. All rights reserved.`,document.querySelector(".logo").style.display="flex",this.startInteraction=!0):(s&&this.guideManager.update(),this.guideManager.draw()),i(),e()}getScaleRatio(t,i){const e=Math.min(this.stageWidth/t,1),s=Math.min(this.stageHeight/i,1);return this.scaleRatio=Math.min(e,s),[this.scaleRatio,e<s?"width":"height"]}setStageSizeByScaledType(t,i,e){t==="width"?(this.stageWidth=Math.max(this.stageWidth,i),this.stageHeight=Math.max(this.stageHeight/this.scaleRatio,e)):t==="height"&&(this.stageWidth=Math.max(this.stageWidth/this.scaleRatio,i),this.stageHeight=Math.max(this.stageHeight,e))}setResizedStageSize(t){this.$canvas.width=this.stageWidth,this.$canvas.height=this.stageHeight;const i=document.querySelector(".app-view");i.style.width=`${this.$canvas.width}px`,i.style.height=`${this.$canvas.height}px`,i.style.transform=`scale(${t})`}initTransitions(){document.body.style.animation="darker linear 1s";const t=100,i=document.querySelectorAll(".mask");for(let e=0;e<i.length;e++)(function(s){setTimeout(function(){i[e].classList.add("animate")},s*t)})(e);setTimeout(()=>{this.$canvas.classList.add("animate")},t*i.length),this.startSpinner=!0}getModules(){return{spinner:this.spinner,ballManager:this.ballManager,pointerManager:this.pointerManager,guideManager:this.guideManager}}}window.onload=()=>{new D(document.getElementById("canvas"))};
